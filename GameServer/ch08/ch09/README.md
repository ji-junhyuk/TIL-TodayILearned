## 분산 서버 구조
### 9.1 수직 확장과 수평 확장

|                           | 수직 확장                                                   | 수평 확장                                               |
|---------------------------|-------------------------------------------------------------|---------------------------------------------------------|
| 확장 종류                 | 서버 머신 부품 업그레이드, 혹은 서버 머신 안 CPU, 램 증설   | 서버 머신 대수 증설                                     |
| 서버 소프트웨어 설계 비용 | 낮다                                                        | 높다                                                    |
| 확장 비용                 | 높다(기하급수적)                                            | 낮다(선형적)                                            |
| 과부하지점                | 서버 컴퓨터 자체                                            | 네트워크 자체                                           |
| 오류 가능성               | 낮다 (로컬 머신 안에서 동기 프로그래밍 방식으로 작동하므로) | 높다 (여러 머신에 걸쳐 비동기 프로그래밍 방식으로 작동  |
| 단위 처리 속도            | 높다 (로컬 컴퓨터의 CPU와 램만 사용)                        | 낮다 (어러 서버 컴퓨터 간 메시징이 오가면서 처리하므로) |
| 처리 가능 총량            | 낮다 (서버 컴퓨터 한 대 성능만 사용하므로)                  | 높다 (어러 서버 컴퓨터로 부하가 분산되므로)             |
### 9.6 로직 처리의 분산 방식들
1. 동기 분산 처리
	- 어떤 연산을 다른 서버에 던져놓고 그 결과가 올 때까지 대기한다. 대기 할 뿐 아니라 그 연산과 관계된 데이터가 도중에 변경되지 않게 잠금(lock)해야 한다.
2. 비동기 분산 처리
	- 다음의 일을 한다.
		- 서버1은 어떤 연산 명령을 다른 서버 2에 송신
		- 서버 1은 서버 2의 명령 처리 결과를 기다리지 않는다. 일방적으로 자기가 해야 하는 다음 일을 시작한다. (이런 방식을 MPI나 액터 모델 등으로 부름)
3. 데이터 복제 및 로컬 처리
	- 각 프로세스는 데이터 원본이나 사본을 가진다
	- 이 전제하에 어떤 연산을 할 때는 서버 프로세스 안의 원본(자기 서버에서 연산되는 데이터)과 사본(다른 서버에서 받은 데이터)을 가지고 연산을 수행
	- 이렇게 분산 천리를 하면, 분산처리에서 발생하는 병목현상이 없을 뿐 아니라 여러 머신에 걸쳐 연산하지도 않으므로 분산하기 전과 같이 빠르다
	- 하지만, 사본 데이터는 원본 데이터와 간발의 차이로 생기는 스테일 데이터 문제가 있을 수 있다. 이떄 서버가 가진 데이터를 모두 신뢰할 경우 데이터 불일치로 인한 연산이 발생할 수 있는데 이를 하이젠버그라고 한다.
### 9.7 데이터 응집도
- 응집도가 높은 데이터끼리는 가급적 분산처리를 하지 말고, 응집도가 낮은 데이터에 대해 분산처리를 하는 것이다.

### 9.8 기능적 분산 처리
- 동기 분산 처리를 하려고 했떠니, 암달의 법칙이 너무 심하게 작용하고.. 비동기 분산 처리를 하려고 했더니, 요청과 응답을 받아야 한다. 또 데이터 복제에 기반을 둔 분산처리를 하려고 했더니, 데이터 일관성이 깨지는 문제가 발생한다. 그러나 안타깝게도 서버에서 과부하가 발생하고 있따면?
- 기능적 분산 처리는 최후 수단이다. 
요약
- 분산 서버: 서버 한 대가 처리 할 수 없는 양을 여러 대가 나누어서 처리하는 것이다.
- 서버 클러스터: 서버 여러대의 집합이다.
- 수평 확장: 서버 개수를 늘려 총 처리량을 늘리는 것이다. 스케일 아웃과 의미가 같다.
- 샤드: 거대한 데이터를 여러 서버 기기로 분산한 후 데이터 일부를 지닌 각 서버 기기를 지칭한다.
- 로드 밸런싱: 한쪽에 과부하가 몰리는 것을 다른 서버와 분배하는 것
- 고가용성: 서버 하드웨어나 소프트웨어가 죽더라도 사용자 입장에서 계속해서 서비스를 이용할 수 있는 것이다.
